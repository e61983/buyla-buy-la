(function(e){function t(t){for(var o,r,a=t[0],c=t[1],u=t[2],l=0,f=[];l<a.length;l++)r=a[l],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&f.push(i[r][0]),i[r]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);d&&d(t);while(f.length)f.shift()();return s.push.apply(s,u||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],o=!0,r=1;r<n.length;r++){var a=n[r];0!==i[a]&&(o=!1)}o&&(s.splice(t--,1),e=c(c.s=n[0]))}return e}var o={},r={app:0},i={app:0},s=[];function a(e){return c.p+"js/"+({}[e]||e)+"."+{"chunk-0bc51c42":"7e80f605","chunk-c308d21e":"ecc7942f"}[e]+".js"}function c(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(e){var t=[],n={"chunk-0bc51c42":1,"chunk-c308d21e":1};r[e]?t.push(r[e]):0!==r[e]&&n[e]&&t.push(r[e]=new Promise((function(t,n){for(var o="css/"+({}[e]||e)+"."+{"chunk-0bc51c42":"299ae35e","chunk-c308d21e":"e97a4b84"}[e]+".css",i=c.p+o,s=document.getElementsByTagName("link"),a=0;a<s.length;a++){var u=s[a],l=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===o||l===i))return t()}var f=document.getElementsByTagName("style");for(a=0;a<f.length;a++){u=f[a],l=u.getAttribute("data-href");if(l===o||l===i)return t()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=t,d.onerror=function(t){var o=t&&t.target&&t.target.src||i,s=new Error("Loading CSS chunk "+e+" failed.\n("+o+")");s.code="CSS_CHUNK_LOAD_FAILED",s.request=o,delete r[e],d.parentNode.removeChild(d),n(s)},d.href=i;var m=document.getElementsByTagName("head")[0];m.appendChild(d)})).then((function(){r[e]=0})));var o=i[e];if(0!==o)if(o)t.push(o[2]);else{var s=new Promise((function(t,n){o=i[e]=[t,n]}));t.push(o[2]=s);var u,l=document.createElement("script");l.charset="utf-8",l.timeout=120,c.nc&&l.setAttribute("nonce",c.nc),l.src=a(e);var f=new Error;u=function(t){l.onerror=l.onload=null,clearTimeout(d);var n=i[e];if(0!==n){if(n){var o=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;f.message="Loading chunk "+e+" failed.\n("+o+": "+r+")",f.name="ChunkLoadError",f.type=o,f.request=r,n[1](f)}i[e]=void 0}};var d=setTimeout((function(){u({type:"timeout",target:l})}),12e4);l.onerror=l.onload=u,document.head.appendChild(l)}return Promise.all(t)},c.m=e,c.c=o,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)c.d(n,o,function(t){return e[t]}.bind(null,o));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/static/",c.oe=function(e){throw console.error(e),e};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=t,u=u.slice();for(var f=0;f<u.length;f++)t(u[f]);var d=l;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"56d7":function(e,t,n){"use strict";n.r(t);n("4160"),n("b64b"),n("159b"),n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),r=n("2f62"),i=n("bc3a"),s=n.n(i),a=n("a7fe"),c=n.n(a),u=n("9062"),l=n.n(u),f=n("ecee"),d=n("ad3d"),m=n("f2d1"),_=n("7bb1"),p=n("60d4"),g=n("4c93"),h=(n("e40d"),n("77ed")),E=n.n(h),S=(n("4989"),n("d3b7"),n("8c4f"));n("a434"),n("ac1f"),n("25f0"),n("3ca3"),n("5319"),n("ddb0"),n("2b3d");function O(){var e=Date.now();return"undefined"!==typeof performance&&"function"===typeof performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))}o["a"].use(r["a"]);var v=new r["a"].Store({state:{is_loading:!0,is_loggedin:!1,liff_context:null,user_profile:null,gid:"",uid:"",records:null,current_goods:[],order_status:"empty",messages:[]},actions:{set_is_loading:function(e,t){e.commit("SET_IS_LOADING",t)},set_is_loggedin:function(e,t){e.commit("SET_IS_LOGGEDIN",t)},set_gid:function(e,t){e.commit("SET_GID",t)},set_order_status:function(e,t){e.commit("SET_ORDER_STATUS",t)},add_good:function(e,t){t.id=O(),e.commit("ADD_GOOD",t)},remove_good:function(e,t){e.commit("REMOVE_GOOD",t)},goods_same_as:function(e,t){e.commit("GOODS_SAME_AS",t)},remove_all_goods:function(e){e.commit("REMOVE_ALL_GOODS")},add_message:function(e,t){var n=O();e.commit("ADD_MESSAGE",{message:t.message,status:t.status,timestamp:n});var o=this;setTimeout((function(){o.state.messages.forEach((function(t,o){t.timestamp===n&&e.commit("REMOVE_MESSAGE",o)}))}),5e3)},remove_message:function(e,t){e.commit("REMOVE_MESSAGE",t)},set_liff_context:function(e,t){e.commit("SET_LIFF_CONTEXT",t),null!==t&&t.hasOwnProperty("groupId")&&e.commit("SET_GID",t.groupId),""===this.state.gid&&e.commit("SET_GID","test")},set_user_profile:function(e,t){e.commit("SET_USER_PROFILE",t)},set_uid:function(e,t){e.commit("SET_UID",t)},get_records:function(e){var t=this,n="https://only-test-0001.herokuapp.com/api/v1/",o=new URL(String(t.state.gid)+"/orders",n).toString();e.commit("SET_IS_LOADING",!0),console.log(o),s.a.get(o).then((function(n){var o=t.state.uid;e.commit("GET_RECORDS",n.data),n.data.hasOwnProperty(t.state.uid)?(e.commit("SET_ORDER_STATUS","exist"),e.commit("SET_GOODS",n.data[o].goods)):e.commit("SET_ORDER_STATUS","empty"),e.commit("SET_IS_LOADING",!1)})).catch((function(t){console.log(t),e.commit("SET_IS_LOADING",!1)}))}},mutations:{SET_IS_LOADING:function(e,t){e.is_loading=t},SET_IS_LOGGEDIN:function(e,t){e.is_loggedin=t},SET_UID:function(e,t){e.uid=t},SET_GID:function(e,t){e.gid=t},SET_ORDER_STATUS:function(e,t){e.order_status=t},ADD_GOOD:function(e,t){e.current_goods.push(t)},REMOVE_GOOD:function(e,t){e.current_goods.forEach((function(n,o){n.id===t&&e.current_goods.splice(o,1)}))},SET_GOODS:function(e,t){e.current_goods=JSON.parse(JSON.stringify(t))},GOODS_SAME_AS:function(e,t){e.current_goods.splice(0,e.current_goods.length),t.forEach((function(t){var n=JSON.parse(JSON.stringify(t));n.id=O(),e.current_goods.push(n)}))},REMOVE_ALL_GOODS:function(e){e.current_goods.splice(0,e.current_goods.length)},ADD_MESSAGE:function(e,t){e.messages.push({message:t.message,status:t.status,timestamp:t.timestamp})},REMOVE_MESSAGE:function(e,t){e.messages.splice(t,1)},SET_LIFF_CONTEXT:function(e,t){e.liff_context=t},SET_USER_PROFILE:function(e,t){e.user_profile=t},GET_RECORDS:function(e,t){e.records=t}}});o["a"].use(S["a"]);var b=new S["a"]({routes:[{path:"/",name:"Home",redirect:{name:"Menu"}},{path:"/menu",name:"Menu",component:function(){return n.e("chunk-0bc51c42").then(n.bind(null,"add6"))},beforeEnter:function(e,t,n){console.log(v.state.is_loggedin),v.state.is_loggedin?n():n({name:"Page_404"})}},{path:"/404",name:"Page_404",component:function(){return n.e("chunk-c308d21e").then(n.bind(null,"9303"))}},{path:"*",name:"Unknow",redirect:{name:"Page_404"}}]}),y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container mt-3",attrs:{id:"app"}},[n("Alert",{attrs:{id:"msg",msg:"Ops~",state:"alert-danger"}}),n("router-view"),n("loading",{attrs:{loader:"dots",active:e.api_loading,"can-cancel":!1,"is-full-page":!1},on:{"update:active":function(t){e.api_loading=t}}})],1)},x=[],T=(n("b0c0"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"message-alert"},e._l(e.messages,(function(t,o){return n("div",{key:o,staticClass:"alert alert-dismissible",class:"alert-"+t.status},[e._v(" "+e._s(t.message)+" "),n("button",{staticClass:"close",attrs:{type:"button","aria-label":"Close"},on:{click:function(t){return e.removeMessage(o)}}},[n("span",{attrs:{"aria-hidden":"true"}},[e._v("Ã—")])])])})),0)}),D=[],A={name:"Alert",computed:{messages:function(){return this.$store.state.messages}},methods:{removeMessage:function(e){this.$store.dispatch("remove_message",e)}}},I=A,G=(n("82d5"),n("2877")),M=Object(G["a"])(I,T,D,!1,null,null,null),w=M.exports,R={name:"app",components:{Alert:w},data:function(){return{initialized:!1}},created:function(){console.log(this.$options.name,"created"),console.log("process.env.NODE_ENV: ".concat("production")),console.log("process.env.VUE_APP_LIFF_ID: ".concat("1653816155-R77M7Yly")),this.init_liff()},BeforeMount:function(){console.log(this.$options.name,"BeforeMount")},beforeDestroy:function(){console.log(this.$options.name,"BeforeMount"),this.$liff.logout()},computed:{api_loading:function(){return this.$store.state.is_loading}},methods:{init_liff:function(){var e=this;e.$store.dispatch("set_is_loading",!0),e.$liff.init({liffId:"1653816155-R77M7Yly"},(function(){!0===e.$liff.isInClient()||!0===e.$liff.isLoggedIn()?(e.$store.dispatch("set_is_loggedin",!0),e.$store.dispatch("set_liff_context",e.$liff.getContext()),e.$liff.getProfile().then((function(t){e.$store.dispatch("set_user_profile",{display_name:t.displayName,photo_url:t.pictureUrl}),e.$store.dispatch("set_uid",t.userId)})).then((function(){e.$store.dispatch("get_records")})).catch((function(e){console.log("error",e)}))):(console.log("login..."),e.$liff.login())})).then((function(){console.log("app: "+e.$store.state.is_loggedin),e.$store.dispatch("set_is_loading",!1),e.$store.state.is_loggedin&&e.$router.push({name:"Menu"})})).catch((function(e){console.log(e)}))}}},$=R,L=(n("5c0b"),Object(G["a"])($,y,x,!1,null,null,null)),k=L.exports;Object.keys(g).forEach((function(e){Object(_["c"])(e,g[e])})),Object(_["d"])("zh_TW",p),f["c"].add(m["b"]),f["c"].add(m["a"]),o["a"].use(c.a,s.a),o["a"].use(r["a"]),o["a"].use(E.a),o["a"].component("font-awesome-icon",d["a"]),o["a"].component("Loading",l.a),o["a"].component("ValidationProvider",_["b"]),o["a"].component("ValidationObserver",_["a"]),o["a"].config.productionTip=!1,o["a"].prototype.$liff=window.liff,new o["a"]({el:"#app",router:b,store:v,render:function(e){return e(k)}}),b.beforeEach((function(e,t,n){console.log(t,e),console.log("store "+v.state.is_loggedin),n()}))},"5c0b":function(e,t,n){"use strict";var o=n("9c0c"),r=n.n(o);r.a},"82d5":function(e,t,n){"use strict";var o=n("dccc"),r=n.n(o);r.a},"9c0c":function(e,t,n){},dccc:function(e,t,n){}});
//# sourceMappingURL=app.321680cb.js.map